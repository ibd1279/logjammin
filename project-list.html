<?lc if request:has_attribute("_error") then ?><div class="error">
    ${_html(request:attribute("_error"))}
</div><?lc end ?>
<div>
    <form action="project-search">
        <label for="q">Search</label>
        <input type="text" name="q" value="${_html(request:param("q"))}" />
        <input type="submit" value="Search" />
    </form>
</div>
<?lc if request:has_param("q") then ?><div>
    Search results for &quot;${_html(request:param("q"))}&quot;.
</div><?lc else ?><div>
    <a href="project-edit">Create a new project...</a>
</div><?lc end ?>
<table>
  <thead>
  <tr>
    <th>
      Project
    </th>
    <th>
      Versions
    </th>
  </tr>
  </thead>
  <tbody>
  <?lc if projects and table.getn(projects) > 0 then ?>
    <?lc for h, project in ipairs(projects) do ?>
    <tr>
      <td><?lc if _user:check_allowed("backlog:project:write") then ?><a href="${project:pkey()}/project-edit">${_html(project:name())}</a><?lc else ?>${_html(project:name())}<?lc end ?></td>
      <td><?lc for i, version in ipairs(project:versions()) do ?>${i == 1 and "" or ", "}<?lc if _user:check_allowed("backlog:backlog:read") then ?><a href="${project:pkey()}/${_html(version)}/backlog-list">${_html(version)}</a><?lc else ?>${_html(version)}<?lc end ?><?lc end ?></td>
    </tr>
    <?lc end ?>
  <?lc else ?>
    <tr><td colspan="2">No projects found.</td></tr>
  <?lc end ?>
  </tbody>
</table>
